<!doctype html>
<html lang="no">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Borregaard Dashboard - Arbeidsrettet lageroptimalisering"
    />
    <title>Borregaard Dashboard</title>
    <link rel="stylesheet" href="css/dashboard.css" />
  </head>
  <body>
    <div class="container">
      <!-- HEADER -->
      <header class="main-header">
        <h1>Borregaard Dashboard</h1>
        <p class="subtitle">Arbeidsrettet beslutningstÃ¸tte for lagerstyring</p>
      </header>

      <!-- FILE UPLOAD SECTION -->
      <section class="upload-section">
        <h2>Last opp data</h2>

        <!-- Multi-file drop zone -->
        <div id="multiDropZone" class="multi-drop-zone">
          <div class="drop-zone-content">
            <div class="drop-zone-icon">ğŸ“‚</div>
            <p class="drop-zone-text">Dra inn Excel-filer her</p>
            <p class="drop-zone-hint">(Master.xlsx, Ordrer_Jeeves.xlsx)</p>
          </div>
        </div>
        <div id="dropStatus" class="drop-status"></div>

        <p class="upload-divider"><span>eller velg filer enkeltvis</span></p>

        <div class="upload-grid six-columns">
          <div class="upload-item">
            <label for="masterFile">
              <span class="file-label">Master</span>
              <span class="file-required">(pÃ¥krevd)</span>
            </label>
            <input type="file" id="masterFile" accept=".xlsx,.csv" />
            <span class="file-hint">Artikkeldata, saldo, status, bestillinger, alternativer</span>
          </div>
          <div class="upload-item">
            <label for="ordersOutFile">
              <span class="file-label">Ordrer (salg ut)</span>
              <span class="file-required">(pÃ¥krevd)</span>
            </label>
            <input type="file" id="ordersOutFile" accept=".xlsx,.csv" />
            <span class="file-hint">Ordrer_Jeeves â€“ salgsordrer ut</span>
          </div>
        </div>
        <div class="upload-actions">
          <button id="uploadBtn" class="btn-primary">Analyser data</button>
          <button id="clearBtn" class="btn-secondary">Nullstill</button>
        </div>
        <div id="uploadStatus" class="status-message"></div>
      </section>

      <!-- SUMMARY CARDS -->
      <section class="summary-cards">
        <div class="summary-card">
          <div class="card-value" id="totalItems">-</div>
          <div class="card-label">Totalt artikler</div>
        </div>
        <div class="summary-card card-critical">
          <div class="card-value" id="criticalCount">-</div>
          <div class="card-label">Kritiske</div>
        </div>
        <div class="summary-card card-warning">
          <div class="card-value" id="warningCount">-</div>
          <div class="card-label">Advarsler</div>
        </div>
        <div class="summary-card card-ok">
          <div class="card-value" id="saNumberCoverage">-</div>
          <div class="card-label">SA-dekning</div>
        </div>
        <div class="summary-card">
          <div class="card-value" id="incomingCount">-</div>
          <div class="card-label">PÃ¥ vei inn</div>
        </div>
      </section>

      <!-- TAB NAVIGATION - 5 ARBEIDSMODUSER -->
      <nav class="tab-navigation">
        <button class="tab active" data-module="overview">
          <span class="tab-icon">1</span>
          <span class="tab-label">Oversikt</span>
          <span class="tab-desc">Daglig kontroll</span>
        </button>
        <button class="tab" data-module="demand">
          <span class="tab-icon">2</span>
          <span class="tab-label">EtterspÃ¸rsel</span>
          <span class="tab-desc">Salg & mÃ¸nstre</span>
        </button>
        <button class="tab" data-module="assortment">
          <span class="tab-icon">3</span>
          <span class="tab-label">Sortiment</span>
          <span class="tab-desc">Rydding</span>
        </button>
        <button class="tab" data-module="planning">
          <span class="tab-icon">4</span>
          <span class="tab-label">Planlegging</span>
          <span class="tab-desc">Forberedelser</span>
        </button>
        <button class="tab" data-module="alternatives">
          <span class="tab-icon">5</span>
          <span class="tab-label">Alternativer</span>
          <span class="tab-desc">UtgÃ¥ende analyse</span>
        </button>
      </nav>

      <!-- MODULE CONTENT AREA -->
      <main id="moduleContent" class="module-content">
        <div class="placeholder-content">
          <div class="placeholder-icon">ğŸ“Š</div>
          <h3>Last opp data for Ã¥ starte</h3>
          <p>Last opp de 2 pÃ¥krevde filene for Ã¥ begynne analysen.</p>
          <ul class="file-checklist">
            <li><strong>Master.xlsx</strong> - Artikkelmasterdata (saldo, status, bestillinger, alternativer)</li>
            <li><strong>Ordrer_Jeeves.xlsx</strong> - Salgsordrer ut (etterspÃ¸rselsanalyse)</li>
          </ul>
          <p class="text-muted">StÃ¸ttede formater: .xlsx, .csv</p>
        </div>
      </main>

      <!-- FOOTER -->
      <footer>
        <p>Borregaard Dashboard v4.0 - Arbeidsrettet beslutningstÃ¸tte</p>
        <p class="text-muted">Master.xlsx som single source of truth - Lokal databehandling</p>
      </footer>
    </div>

    <!-- External Libraries -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Core Data Handling -->
    <script src="js/dataLoader.js"></script>
    <script src="js/models/unifiedItem.js"></script>
    <script src="js/dataProcessor.js"></script>

    <!-- Work Modes -->
    <script src="js/workModes/overview.js"></script>
    <script src="js/workModes/demand.js"></script>
    <script src="js/workModes/assortment.js"></script>
    <script src="js/workModes/planning.js"></script>
    <script src="js/workModes/alternatives.js"></script>

    <!-- Legacy modules (for compatibility during transition) -->
    <script src="js/topSellers.js"></script>
    <script src="js/orderSuggestions.js"></script>
    <script src="js/slowMovers.js"></script>
    <script src="js/inactiveItems.js"></script>

    <!-- Main Application Controller -->
    <script src="js/app.js"></script>
  </body>
</html>
